"0",""
"0","#create function to run for the train and test value, get the accuracy rate "
"0","accuracy_check = function(X){"
"0","  predicted <- rep(0,(nrow(data))) "
"0","  "
"0","  for (i in 1:nrow(data))"
"0","  {"
"0","    "
"0","    #define model for calculation"
"0","    knn_credit=kknn(V11~.,knndata[-i,],knndata[i,],k=X, scale = TRUE) "
"0","    "
"0","    predicted[i] <- as.integer(fitted(knn_credit)+0.5) # round off to 0 or 1"
"0","  }"
"0","  "
"0","  # calculate % of correct predictions"
"0","  accuracy<- sum(predicted == knndata[,11]) / nrow(data)"
"0","  return(accuracy)"
"0","}"
"0",""
"0","# generate number from 1-20 of k values to test accuracy rate"
"0","kknn_accuracy<- rep(0,20)"
"0",""
"0","for (i in 1:20)"
"0","{"
"0","  #looping k value"
"0","  kknn_accuracy[i] <- accuracy_check(i)"
"0","}"
"0",""
